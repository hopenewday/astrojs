---
import BaseLayout from "../layouts/BaseLayout.astro";
import FlashFeed from "../components/FlashFeed.jsx";

// Sample data for demonstration (same as in index.astro)
const articles = [
  {
    id: "1",
    title: "The Future of Artificial Intelligence in 2023",
    slug: "future-of-ai-2023",
    excerpt: "Exploring the latest advancements in AI and what they mean for society, business, and everyday life.",
    image: "/images/tech/ai-future.jpg",
    category: {
      name: "Tech",
      slug: "tech"
    },
    author: {
      name: "Alex Johnson",
      slug: "alex-johnson",
      avatar: "/images/authors/alex-johnson.jpg"
    },
    publishDate: new Date("2023-06-15"),
    trending: true,
    featured: true
  },
  {
    id: "2",
    title: "Modern Web Development Frameworks Compared",
    slug: "web-frameworks-compared",
    excerpt: "An in-depth analysis of the most popular web development frameworks in 2023, including React, Vue, and Svelte.",
    image: "/images/tech/web-dev.jpg",
    category: {
      name: "Tech",
      slug: "tech"
    },
    author: {
      name: "Sarah Chen",
      slug: "sarah-chen",
      avatar: "/images/authors/sarah-chen.jpg"
    },
    publishDate: new Date("2023-06-10")
  },
  {
    id: "3",
    title: "The Renaissance of Indie Filmmaking",
    slug: "indie-film-renaissance",
    excerpt: "How digital technology and streaming platforms are giving independent filmmakers unprecedented opportunities.",
    image: "/images/culture/indie-film.jpg",
    category: {
      name: "Culture",
      slug: "culture"
    },
    author: {
      name: "Michael Rivera",
      slug: "michael-rivera",
      avatar: "/images/authors/michael-rivera.jpg"
    },
    publishDate: new Date("2023-06-05")
  },
  {
    id: "4",
    title: "Climate Change: The Latest Research",
    slug: "climate-change-research",
    excerpt: "A summary of the most recent scientific findings on climate change and their implications for global policy.",
    image: "/images/science/climate.jpg",
    category: {
      name: "Science",
      slug: "science"
    },
    author: {
      name: "Dr. Emily Wong",
      slug: "emily-wong",
      avatar: "/images/authors/emily-wong.jpg"
    },
    publishDate: new Date("2023-06-01"),
    trending: true
  },
  {
    id: "5",
    title: "The Global Economy in a Post-Pandemic World",
    slug: "post-pandemic-economy",
    excerpt: "Analyzing the long-term economic impacts of the pandemic and strategies for sustainable recovery.",
    image: "/images/business/economy.jpg",
    category: {
      name: "Business",
      slug: "business"
    },
    author: {
      name: "Robert Kiyosaki",
      slug: "robert-kiyosaki",
      avatar: "/images/authors/robert-kiyosaki.jpg"
    },
    publishDate: new Date("2023-05-28")
  }
];

// Sort articles by publish date (newest first)
const sortedArticles = [...articles].sort((a, b) => 
  b.publishDate.getTime() - a.publishDate.getTime()
);

// Take the 10 latest articles
const latestArticles = sortedArticles.slice(0, 10);

// Client-side redirect for desktop users
---

<BaseLayout title="Flash Feed - ChakrirChain" description="Explore the latest articles in our Flash feed">
  <div id="flash-container">
    <FlashFeed articles={latestArticles} client:load />
  </div>
</BaseLayout>

<script>
  // Redirect desktop users to homepage
  document.addEventListener('DOMContentLoaded', () => {
    const isMobile = window.innerWidth <= 768 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    if (!isMobile) {
      window.location.href = '/';
    }
  });
</script>

<style>
  #flash-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    overflow: hidden;
  }
</style>